nodes:
  - node_id: flow-1#2
    title: "PDF 转换 #2"
    inputs_from:
      - handle: file
        value: /oomol-driver/oomol-storage/pdf/page_range_1_1-100.pdf
      - handle: api_token
        value: ${{OO_SECRET:Custom,mineru,api-key}}
      - handle: is_ocr
        value: true
      - handle: enable_formula
        value: true
      - handle: enable_table
        value: true
      - handle: max_retries
        value:
    subflow: self::pdf-to-markdown
  - node_id: extract_zip#1
    title: "Extract ZIP #1"
    inputs_from:
      - handle: zip_file
        from_node:
          - node_id: url2file#1
            output_handle: file
      - handle: zip_dir
        value: null
      - handle: password
        value: null
    task: zip::extract_zip
  - node_id: list_files_from_folder#1
    title: "List files from folder #1"
    inputs_from:
      - handle: folder
        from_node:
          - node_id: extract_zip#1
            output_handle: output
      - handle: sort
        value: false
      - handle: traverse
        value: false
      - handle: absolute_path
        value: true
    task: oomol-file::list_files_from_folder
  - node_id: +python#1
    title: "Python #1"
    icon: ":logos:python:"
    task:
      ui:
        default_width: 450
      inputs_def:
        - handle: file_paths
          description: If the folder does not exist, an empty array is returned here
          json_schema:
            type: array
            items:
              type: string
              ui:widget: file
      outputs_def:
        - handle: markdown_file
          json_schema:
            type: string
            ui:widget: file
      executor:
        name: python
        options:
          entry: scriptlets/+scriptlet#1.py
    inputs_from:
      - handle: file_paths
        from_node:
          - node_id: list_files_from_folder#1
            output_handle: file_paths
  - node_id: markdown-to-epub#1
    title: "Markdown 转 EPUB #1"
    inputs_from:
      - handle: markdown_file
        from_node:
          - node_id: +python#1
            output_handle: markdown_file
      - handle: output_path
        value: /oomol-driver/oomol-storage/epub/hello.epub
      - handle: title
        value:
      - handle: author
        value:
      - handle: theme
        value: modern
    task: self::markdown-to-epub
  - node_id: url2file#1
    title: "URL to file #1"
    inputs_from:
      - handle: url
        from_node:
          - node_id: flow-1#2
            output_handle: epub_file
      - handle: saved_folder
        value: null
      - handle: ensure_folder
        value: false
      - handle: file_head
        value: null
      - handle: if_existing
        value: override
      - handle: threads_count
        value: 1
      - handle: headers
        value:
          {}
      - handle: cookies
        value:
          {}
      - handle: window_width
        value: 7
      - handle: failure_ladder
        value:
          - 5
      - handle: min_segment_length
        value: 1048576
      - handle: once_fetch_size
        value: 16384
      - handle: timeout
        value: 30
      - handle: retry_times
        value: 0
      - handle: retry_sleep
        value: 0
    subflow: downloader::url2file
  - node_id: pdf-to-markdown#1
    title: "PDF to markdown #1"
    inputs_from:
      - handle: file
      - handle: api_token
        value: ${{OO_SECRET:Custom,mineru,api-key}}
      - handle: is_ocr
        value: true
      - handle: enable_formula
        value: true
      - handle: enable_table
        value: true
      - handle: max_retries
        value: null
    subflow: self::pdf-to-markdown
